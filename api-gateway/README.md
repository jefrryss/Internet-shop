# API Gateway Service

**API Gateway** — это единая точка входа для микросервисной архитектуры Gozon. Сервис реализует паттерн **Backend for Frontend (BFF)**, скрывая сложность внутренней сети от внешних клиентов и обеспечивая централизованную маршрутизацию и безопасность.

---

## Основные возможности

1.  **Единая точка входа:** Клиенты (Web, Mobile, Swagger) обращаются только к порту `8000`. Порты микросервисов (`8080`, `8081`) скрыты внутри Docker-сети.
2.  **Маршрутизация запросов:** Умное перенаправление трафика:
    * `/orders` → **Order Service**
    * `/accounts` → **Payment Service**
3.  **Управление CORS:** Централизованная настройка заголовков `Access-Control-Allow-Origin` для корректной работы браузерных клиентов и Swagger UI.
4.  **Clean Architecture:** Проект построен по принципам чистой архитектуры для легкости поддержки и масштабирования.

---

## Структура проекта

Мы используем стандартную структуру Go-проекта (Standard Go Project Layout), разделяя код на слои ответственности.

```text
api-gateway/
├── cmd/
│   └── main.go              # Точка входа (Entrypoint)
├── internal/
│   ├── config/              # Конфигурация приложения
│   ├── router/              # Маршрутизация и Middleware
│   ├── handler/             # Слой доставки 
│   └── service/             # Бизнес-логика 
├── Dockerfile               # Инструкции для сборки образа
└── go.mod                   # Зависимости
```

## Принцип работы


1.  **Маршрутизация и Middleware**
    Входящий запрос поступает на публичный порт. Система применяет CORS-политики (для доступа из браузера) и логирует запрос. Роутер определяет целевой сервис на основе URL (например, префикс `/orders` или `/accounts`).

2.  **Обработка**
    Хендлер формирует URL для внутренней сети Docker. Он валидирует наличие обязательных заголовков (например, X-User-Id), необходимых для идентификации пользователя в микросервисах.

3.  **Проксирование**
    Gateway создает новый HTTP-запрос и отправляет его соответствующему микросервису. Получив ответ, он передает статус-код и тело ответа обратно клиенту без изменений.

## API Эндпоинты

Все запросы выполняются на адрес: `http://localhost:8000`

### Сервис Заказов (Order Service)

| Метод | URL | Описание |
| :--- | :--- | :--- |
| POST | `/orders` | Создать новый заказ |
| GET | `/orders` | Получить список всех заказов |
| GET | `/orders/{id}` | Получить детали заказа по ID |

### Сервис Оплат (Payment Service)

| Метод | URL | Описание |
| :--- | :--- | :--- |
| POST | `/accounts` | Создать счет пользователя |
| POST | `/accounts/deposit` | Пополнить баланс |
| GET | `/accounts/balance` | Узнать текущий баланс |

